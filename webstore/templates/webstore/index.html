{% load static %}

<link rel="stylesheet" href="{% static 'webstore/style.css' %}">

<body>
<h1>Webstore</h1>
<br>
<p>hello</p>
<br>
<p>{{token}}</p>

<form method="post">
    {% csrf_token %}
    <button>Add to cart</button>
</form>

<input type="submit" value="Start" onclick="submit()">

<script type="text/javascript">

    function getCookie(name) {
        let cookieValue = null;
        if (document.cookie && document.cookie !== '') {
            const cookies = document.cookie.split(';');
            for (let i = 0; i < cookies.length; i++) {
                const cookie = cookies[i].trim();
                if (cookie.substring(0, name.length + 1) === (name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
    }

    function submit() {
        var xhr = new XMLHttpRequest();
        xhr.onreadystatechange = function () {
            if (xhr.readyState === 4) {
                // Handle the response here
            }
        }

        xhr.open('POST', '/webstore/add_item/1/', true);
        xhr.setRequestHeader('X-CSRFToken', getCookie('csrftoken'));

        xhr.send();
    }

</script>

</body>
